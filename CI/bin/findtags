#!/data/Software/mydan/perl/bin/perl -I/data/Software/mydan/CI/lib -I/data/Software/mydan/CI/private/lib
use strict;
use warnings;

use FindBin qw( $RealBin );
=head1 SYNOPSIS

 $0 id1 id2 ... idn

=cut

$ENV{PATH} = "$ENV{PATH}:/data/Software/mydan/CI/pp";
chdir "$RealBin/.." or die "$0 chdir fail: $!";

sub findtag
{
    my $id = shift;

    die "id err" unless $id =~ /^\d+$/;

    system "date > logs/findtags/$id";
    system "c3_ci_pp_project $id 2>> logs/findtags/$id |c3_ci_pp_autotags 2>>logs/findtags/$id |c3_ci_pp_saveversion >> logs/findtags/$id 2>&1";
}

if( @ARGV )
{
    map{ findtag($_) }@ARGV;
}
else
{
    while(<STDIN>){ chomp; findtag($_); }
}
